<?php
/**
 * Bloque: Autocaravanas categorías
 */

if ( ! defined( 'ABSPATH' ) ) {
	exit;
}

$block_title = get_field( 'title' ) ?: __( 'Encuentra tu autocaravana de segunda mano', 'mauswp' );
$items_tipo   = get_field( 'items_tipo' ) ?: [];
$items_marca  = get_field( 'items_marca' ) ?: [];
$items_motor  = get_field( 'items_motor' ) ?: [];
$items_plazas = get_field( 'items_plazas' ) ?: [];

// Iconos por defecto (inline SVG).
$icons_default = [
	'tipo'   => '<svg class="h-5 w-5" viewBox="0 0 27 21" fill="none" aria-hidden="true"><g clip-path="url(#clip0_33438_1024)"><path d="M27 18.8689V13.7388C26.9803 13.6646 26.962 13.5904 26.9436 13.5162C26.8977 13.3307 26.8545 13.1549 26.7915 12.9955C26.4113 12.02 25.7308 11.3757 24.7697 11.0775C24.5743 11.0171 24.3068 10.8893 24.2426 10.473C24.1324 9.75998 24.0184 9.0483 23.9056 8.33525C23.84 7.92308 23.7745 7.50953 23.7089 7.09736C23.6984 7.0273 23.6971 6.96547 23.6958 6.90502C23.6958 6.88166 23.6958 6.85556 23.6932 6.82671L23.6761 6.42003H24.0642C24.1416 6.42003 24.2203 6.42416 24.2963 6.4269C24.434 6.43377 24.5651 6.44064 24.6661 6.41729C24.7828 6.39118 25.0542 6.33211 25.1656 6.22494C25.6495 5.75919 26.1215 5.25497 26.5765 4.76586L26.8413 4.48147C26.8859 4.43475 26.9305 4.36194 26.9777 4.285C26.9843 4.27401 26.9908 4.26302 26.9987 4.25203V3.98137C26.979 3.95114 26.958 3.91542 26.9397 3.87558L26.6066 3.18039C26.1635 2.25438 25.7045 1.29678 25.2601 0.351535C25.1394 0.0973647 24.986 -0.00292969 24.7094 -0.00292969C19.6285 -0.00292969 14.549 -0.00155579 9.46809 -0.00155579H0.545455C0.163899 0.001192 0 0.174303 0 0.579602C0 6.58765 0 12.5957 0 18.6037C0 19.0269 0.157343 19.1931 0.561189 19.1931H1.09878C2.00481 19.1945 2.94231 19.1959 3.86276 19.189C4.18794 19.1822 4.40166 19.3319 4.53802 19.6452C4.92483 20.5341 5.58829 20.9888 6.50874 20.9971C7.44755 21.0081 8.1215 20.5588 8.51486 19.6685C8.66171 19.336 8.88461 19.1835 9.22946 19.189C13.0004 19.1959 16.7465 19.1959 20.3615 19.189H20.3641C20.722 19.189 20.9489 19.3415 21.0983 19.6836C21.4576 20.5025 22.0804 20.9435 22.9471 20.9957C23.5686 21.0328 24.4052 20.8899 24.8601 19.9982C25.1906 19.3511 25.6482 19.1025 26.3444 19.1945C26.6525 19.2357 26.8505 19.1368 26.9974 18.8689H27ZM6.53497 20.0779C5.82955 20.0779 5.25262 19.4762 5.24869 18.7356C5.24738 18.3592 5.37719 18.0143 5.61451 17.7643C5.85184 17.5156 6.17832 17.3782 6.53365 17.3782C6.8903 17.3782 7.21678 17.5142 7.4528 17.7629C7.69012 18.013 7.81993 18.3578 7.81731 18.737C7.81337 19.4775 7.23776 20.0793 6.53365 20.0793L6.53497 20.0779ZM19.1381 6.15075V18.2479H16.6954C14.2146 18.2479 11.7351 18.2479 9.25437 18.252H9.25175C8.93706 18.252 8.72465 18.138 8.57518 17.8838C8.5542 17.8481 8.53322 17.8083 8.51486 17.767C8.11626 16.8809 7.46853 16.4508 6.53628 16.4508H6.5271C5.59746 16.4536 4.94843 16.8891 4.54327 17.7822C4.45149 17.9855 4.28103 18.2534 3.86276 18.2534C3.85752 18.2534 3.85227 18.2534 3.84703 18.2534C3.57692 18.2493 3.3042 18.2465 3.03147 18.2465C2.75874 18.2465 2.48864 18.2465 2.22115 18.2465C1.98776 18.2465 1.75568 18.2465 1.52229 18.2465C1.46066 18.2465 1.40035 18.2424 1.33348 18.2383L0.895542 18.2136V0.986275L1.3361 0.962919C1.40953 0.957424 1.48164 0.953302 1.55376 0.953302H5.79808C11.8767 0.953302 17.9554 0.953302 24.0341 0.947806C24.3894 0.947806 24.6254 1.10306 24.7775 1.43554C25.087 2.1115 25.4174 2.80394 25.7871 3.55271C25.951 3.88382 25.9012 4.17921 25.639 4.43063C25.5485 4.51856 25.458 4.62435 25.3649 4.73564C25.1591 4.98019 24.9257 5.25772 24.6058 5.39648C24.2675 5.54486 23.8885 5.51876 23.5555 5.4954C23.4532 5.48853 23.3562 5.48304 23.2631 5.48029C23.2448 5.48029 23.2251 5.47892 23.2067 5.47892C22.6206 5.48029 22.0345 5.47892 21.4471 5.47892C20.8872 5.47892 20.3274 5.47892 19.7662 5.47892C19.2705 5.47892 19.1342 5.62317 19.1342 6.148L19.1381 6.15075ZM23.4165 10.9402H20.0677V6.42965H22.6954L23.4152 10.9402H23.4165ZM23.0835 20.0779C23.0835 20.0779 23.0769 20.0779 23.073 20.0779C22.7334 20.0779 22.4135 19.9378 22.1709 19.6836C21.9218 19.4226 21.7867 19.075 21.7906 18.7068C21.7946 18.3345 21.927 17.9951 22.1656 17.7519C22.4069 17.5046 22.7399 17.3714 23.1045 17.3782C23.8151 17.3892 24.3724 17.9841 24.3711 18.7301C24.3711 19.4542 23.7797 20.0711 23.0822 20.0779H23.0835ZM26.1176 18.072L25.896 18.1751C25.7203 18.2561 25.5564 18.2658 25.4108 18.2026C25.2037 18.1119 25.1184 17.9099 25.0896 17.8426C24.6949 16.907 24.0367 16.4522 23.0769 16.4508H23.073C22.1276 16.4508 21.4655 16.9056 21.0485 17.8412C20.9869 17.98 20.8872 18.0652 20.8138 18.127C20.7981 18.1407 20.781 18.1545 20.7666 18.1682L20.5188 18.421L20.0612 17.9937V11.8868H21.6713C22.3846 11.8868 23.0979 11.8868 23.8125 11.8868C25.1892 11.8895 26.1149 12.8567 26.1176 14.2952C26.1189 15.1058 26.1176 15.9178 26.1176 16.7311V18.0707V18.072Z" fill="#0F172A"/><path d="M16.5539 6.10984C16.5539 5.61936 16.4227 5.48334 15.9481 5.48197C15.5836 5.48197 15.2191 5.48197 14.8559 5.48334C14.1741 5.48609 13.4699 5.48884 12.775 5.4751C12.7685 5.4751 12.7619 5.4751 12.754 5.4751C12.5718 5.4751 12.4315 5.52456 12.3358 5.62348C12.2046 5.75812 12.1784 5.96558 12.1797 6.11533C12.1994 9.05959 12.1994 12.0203 12.1797 14.9138C12.1784 15.124 12.2296 15.2861 12.3331 15.3933C12.4629 15.5279 12.6505 15.5554 12.7855 15.5526C13.4713 15.543 14.1688 15.5444 14.8414 15.5471C15.2046 15.5471 15.5665 15.5485 15.9297 15.5471C16.4123 15.5471 16.5525 15.4015 16.5525 14.9C16.5525 13.8682 16.5525 12.8378 16.5525 11.806V10.5324V9.23545C16.5525 8.19266 16.5525 7.14988 16.5525 6.10846L16.5539 6.10984ZM15.6465 14.5758H13.0897V6.4327H15.6465V14.5758Z" fill="#0F172A"/><path d="M3.47201 6.06016C3.4707 7.20462 3.4707 8.3477 3.47201 9.49078C3.47201 9.88234 3.63591 10.0582 4.00042 10.0596C4.59046 10.0623 5.17918 10.0623 5.76922 10.0609H6.54282H7.29413C7.88285 10.0609 8.47027 10.0609 9.05899 10.0596C9.43137 10.0582 9.59789 9.88509 9.59789 9.5004C9.60051 8.3477 9.60051 7.195 9.59789 6.0423C9.59789 5.66311 9.43268 5.48587 9.08128 5.4845C8.2395 5.48038 7.37936 5.479 6.51004 5.479C5.64072 5.479 4.83958 5.48038 3.99518 5.4845C3.62805 5.48587 3.47201 5.65898 3.4707 6.06016H3.47201ZM4.38329 6.43111H8.67875V9.11845H4.38329V6.43111Z" fill="#0F172A"/></g><defs><clipPath id="clip0_33438_1024"><rect width="27" height="21" fill="white"/></clipPath></defs></svg>',
	'marca'  => '<svg class="h-5 w-5" viewBox="0 0 16 16" fill="none" aria-hidden="true"><path d="M8.00147 16C6.89495 16 5.85488 15.79 4.88126 15.3701C3.90765 14.9502 3.06077 14.3803 2.34063 13.6604C1.62049 12.9406 1.05032 12.094 0.630105 11.1208C0.210035 10.1476 0 9.10786 0 8.00147C0 6.89495 0.210035 5.85488 0.630105 4.88126C1.05003 3.90765 1.62 3.06077 2.34 2.34063C3.06 1.62049 3.90667 1.05032 4.88 0.630105C5.85333 0.210035 6.89333 0 8 0C8.88702 0 9.72632 0.133333 10.5179 0.4C11.3095 0.666667 12.0356 1.0386 12.6964 1.51579L11.7829 2.45032C11.2388 2.07558 10.6494 1.78407 10.0147 1.57579C9.38007 1.36737 8.70849 1.26316 8 1.26316C6.13333 1.26316 4.54386 1.9193 3.23158 3.23158C1.9193 4.54386 1.26316 6.13333 1.26316 8C1.26316 9.86667 1.9193 11.4561 3.23158 12.7684C4.54386 14.0807 6.13333 14.7368 8 14.7368C9.86667 14.7368 11.4561 14.0807 12.7684 12.7684C14.0807 11.4561 14.7368 9.86667 14.7368 8C14.7368 7.70414 14.7174 7.41158 14.6785 7.12232C14.6396 6.83305 14.5813 6.55179 14.5036 6.27853L15.5238 5.25032C15.6782 5.68316 15.7961 6.12849 15.8777 6.58632C15.9592 7.044 16 7.51523 16 8C16 9.10667 15.79 10.1467 15.3701 11.12C14.9502 12.0933 14.3803 12.94 13.6604 13.66C12.9406 14.38 12.094 14.95 11.1208 15.3699C10.1476 15.79 9.10786 16 8.00147 16ZM6.80484 11.5821L3.51747 8.29474L4.40484 7.40737L6.80484 9.80737L15.1126 1.48674L16 2.37411L6.80484 11.5821Z" fill="#475569"/></svg>',
	'motor'  => '<svg class="h-5 w-5" viewBox="0 0 18 11" fill="none" aria-hidden="true"><path d="M1.7167 6.77367H0.870556C0.870556 6.84475 0.870556 6.91261 0.870556 6.98369C0.870556 7.5782 0.870556 8.16948 0.870556 8.76399C0.870556 8.84799 0.863997 8.93846 0.83448 9.01601C0.772168 9.19371 0.637703 9.29387 0.440926 9.29711C0.244149 9.30034 0.109685 9.20664 0.0375334 9.03216C0.0145761 8.98047 0.00145761 8.91908 0.00145761 8.86092C0.00145761 7.18724 -0.00182201 5.51034 0.00145761 3.83667C0.00145761 3.52326 0.263827 3.3294 0.555713 3.40694C0.74921 3.45864 0.873836 3.63311 0.873836 3.87867C0.873836 4.47964 0.873836 5.07738 0.873836 5.67835C0.873836 5.74944 0.873836 5.82052 0.873836 5.90453H1.71998C1.71998 5.40695 1.71998 4.91906 1.71998 4.43118C1.71998 4.24055 1.71998 4.04992 1.71998 3.85605C1.72326 3.54264 1.8774 3.38755 2.20536 3.38432C2.63499 3.37786 3.06134 3.37786 3.49097 3.38432C3.62871 3.38432 3.7271 3.34555 3.82549 3.24862C4.2748 2.79628 4.73395 2.35363 5.18325 1.90128C5.32428 1.75912 5.47186 1.68803 5.67848 1.6945C6.06547 1.70742 6.45247 1.69773 6.8493 1.69773V0.870583C6.79027 0.870583 6.72795 0.86089 6.66236 0.86089C6.31472 0.86089 5.96708 0.86089 5.61944 0.86089C5.3374 0.857659 5.14062 0.676721 5.14062 0.431163C5.14062 0.185605 5.33412 0.00143601 5.61616 0.00143601C6.73451 0.00143601 7.84958 -0.00179502 8.96793 0.00143601C9.24014 0.00143601 9.42708 0.182374 9.43036 0.42147C9.43364 0.670259 9.2467 0.854428 8.96465 0.86089C8.55798 0.867352 8.15131 0.86089 7.73152 0.86089V1.69773C8.12835 1.69773 8.51534 1.69773 8.90234 1.69773C9.1975 1.69773 9.49267 1.70419 9.78456 1.69773C9.96822 1.69126 10.106 1.75588 10.2306 1.87866C10.6865 2.33424 11.1489 2.78335 11.6047 3.23893C11.7064 3.33909 11.8048 3.38755 11.9557 3.38432C12.3689 3.37463 12.7854 3.37786 13.1986 3.38432C13.5627 3.38755 13.7234 3.54587 13.7234 3.90775C13.7234 4.28901 13.7234 4.66704 13.7234 5.058H14.5695C14.5695 4.74459 14.5826 4.42795 14.5695 4.11454C14.5302 3.40371 14.7761 3.36817 15.3173 3.37786C15.7469 3.38755 16.1733 3.38432 16.6029 3.37786C16.8029 3.37786 16.9636 3.43602 17.1014 3.58142C17.331 3.82051 17.5704 4.05315 17.8098 4.28255C17.9377 4.40533 18 4.54426 18 4.72197C18 6.36333 18 8.00469 18 9.64606C18 9.82053 17.9442 9.9627 17.8131 10.0855C17.5605 10.3213 17.331 10.5831 17.0686 10.806C16.9538 10.9029 16.78 10.9805 16.6291 10.9869C16.1142 11.0096 15.5993 10.9966 15.0844 10.9934C14.7335 10.9934 14.5728 10.8318 14.5728 10.4829C14.5728 10.0952 14.5728 9.70745 14.5728 9.31003H13.7267C13.7267 9.69129 13.7267 10.0661 13.7267 10.4409C13.7267 10.8351 13.566 10.9966 13.1691 10.9966C10.6799 10.9966 8.19066 10.9966 5.70143 10.9966C5.49154 10.9966 5.33084 10.932 5.18325 10.7866C4.73067 10.331 4.26496 9.88192 3.80909 9.42635C3.71726 9.33588 3.62871 9.29387 3.49425 9.29711C3.05806 9.30357 2.62515 9.30034 2.18896 9.29711C1.88068 9.29711 1.71998 9.13879 1.7167 8.83507C1.7167 8.15655 1.7167 7.47804 1.7167 6.77367ZM2.5858 8.44735C2.98591 8.44735 3.36635 8.45058 3.74678 8.44735C3.94684 8.44411 4.10426 8.50874 4.24528 8.6509C4.69459 9.10324 5.15374 9.5459 5.60304 9.99824C5.69815 10.0952 5.79326 10.1372 5.93429 10.1372C8.16115 10.1339 10.3913 10.1372 12.6181 10.1372C12.6903 10.1372 12.7592 10.1372 12.8412 10.1372C12.8412 9.7333 12.8412 9.3585 12.8412 8.9837C12.8412 8.6089 12.9953 8.45381 13.3757 8.45381C13.8513 8.45381 14.3268 8.45381 14.8024 8.45381C15.2976 8.45381 15.4222 8.57336 15.4222 9.05801C15.4222 9.41342 15.4222 9.7656 15.4222 10.1404C15.5928 10.1404 15.7403 10.121 15.8814 10.1436C16.3471 10.2179 16.7045 10.0661 16.9899 9.69452C17.0784 9.57821 17.1375 9.47804 17.1375 9.32942C17.1309 8.05639 17.1079 6.78337 17.1473 5.51357C17.1637 5.02245 17.0489 4.64766 16.6455 4.36333C16.593 4.32455 16.5438 4.25024 16.4914 4.24701C16.1405 4.23731 15.7895 4.24055 15.4222 4.24055C15.4222 4.65735 15.4222 5.04507 15.4222 5.4328C15.4189 5.78175 15.2582 5.93361 14.9008 5.93684C14.399 5.93684 13.8972 5.93684 13.3954 5.93684C13.0084 5.93684 12.8444 5.77528 12.8444 5.40049C12.8444 5.01922 12.8444 4.64119 12.8444 4.24055C12.4378 4.24055 12.0508 4.23408 11.6638 4.24055C11.467 4.24701 11.3194 4.18239 11.1817 4.04668C10.7258 3.59111 10.2699 3.13553 9.80095 2.69288C9.72552 2.6218 9.59762 2.56364 9.49267 2.56364C8.30217 2.55395 7.11167 2.55395 5.92117 2.56364C5.81622 2.56364 5.68831 2.6218 5.61288 2.69611C5.18981 3.09676 4.76674 3.50387 4.36663 3.92714C4.15017 4.15654 3.9206 4.26963 3.59592 4.24701C3.26468 4.22116 2.93016 4.24055 2.5858 4.24055V8.45381V8.44735Z" fill="#0F172A"/></svg>',
	'plazas' => '<svg class="h-5 w-5" viewBox="0 0 19 19" fill="none" aria-hidden="true"><path d="M9.02051 10.7437C10.0451 10.7437 11.0692 10.8664 12.0918 11.1118C13.1143 11.3574 14.1355 11.7261 15.1553 12.2163H15.1562C15.6078 12.4379 15.9687 12.7504 16.2373 13.1528C16.5058 13.5557 16.6415 13.9904 16.6416 14.4556V16.3286H1.40039V14.4556C1.40047 13.9905 1.53535 13.5556 1.80371 13.1528C2.07234 12.7503 2.43409 12.4379 2.88574 12.2163H2.88672C3.90648 11.7261 4.92768 11.3574 5.9502 11.1118C6.97256 10.8665 7.99608 10.7437 9.02051 10.7437ZM9.02051 12.021C8.07231 12.021 7.13258 12.1342 6.20117 12.3608C5.26913 12.5876 4.36415 12.9141 3.48633 13.3403C3.22718 13.4793 3.02829 13.6474 2.88574 13.8423C2.74364 14.0364 2.67489 14.24 2.6748 14.4556V15.0522H15.3672V14.4556C15.3671 14.2401 15.2983 14.0364 15.1562 13.8423C15.0137 13.6474 14.8147 13.4792 14.5557 13.3403C13.6778 12.9141 12.7729 12.5876 11.8408 12.3608C10.9093 12.1342 9.96886 12.021 9.02051 12.021ZM9.02051 1.87939C9.9337 1.87939 10.7184 2.20653 11.3682 2.85791C12.0178 3.50923 12.3438 4.29539 12.3438 5.21045C12.3437 6.12547 12.0179 6.91171 11.3682 7.56299C10.7184 8.21428 9.93365 8.5415 9.02051 8.5415C8.10759 8.54143 7.32349 8.2141 6.67383 7.56299C6.02413 6.91171 5.69736 6.12547 5.69727 5.21045C5.69727 4.29531 6.02411 3.50926 6.67383 2.85791C7.32355 2.20661 8.10745 1.87947 9.02051 1.87939ZM9.02051 3.15576C8.45661 3.15584 7.97633 3.35625 7.57422 3.75928C7.17199 4.16249 6.97168 4.64474 6.97168 5.21045C6.97177 5.77598 7.17208 6.25753 7.57422 6.66064C7.97635 7.06373 8.45656 7.26408 9.02051 7.26416C9.58462 7.26416 10.0655 7.06385 10.4678 6.66064C10.8698 6.25755 11.0692 5.77593 11.0693 5.21045C11.0693 4.64475 10.87 4.16248 10.4678 3.75928C10.0655 3.35608 9.58462 3.15576 9.02051 3.15576Z" fill="#475569" stroke="#475569" stroke-width="0.2"/></svg>',
	'arrow'  => '<svg class="h-4 w-4" viewBox="0 0 24 24" fill="none" aria-hidden="true"><path d="M9 6l6 6-6 6" stroke="currentColor" stroke-width="1.8" stroke-linecap="round" stroke-linejoin="round"/></svg>',
];

$filter_tipo_label   = get_field( 'filter_tipo_label' ) ?: __( 'Tipo de autocaravana', 'mauswp' );
$filter_tipo_icon    = get_field( 'filter_tipo_icon' );
$filter_marca_label  = get_field( 'filter_marca_label' ) ?: __( 'Marca', 'mauswp' );
$filter_marca_icon   = get_field( 'filter_marca_icon' );
$filter_motor_label  = get_field( 'filter_motor_label' ) ?: __( 'Motor', 'mauswp' );
$filter_motor_icon   = get_field( 'filter_motor_icon' );
$filter_plazas_label = get_field( 'filter_plazas_label' ) ?: __( 'Plazas', 'mauswp' );
$filter_plazas_icon  = get_field( 'filter_plazas_icon' );

$filters = [
	'tipo'   => [
		'label' => $filter_tipo_label,
		'icon'  => $filter_tipo_icon ?: $icons_default['tipo'],
		'items' => $items_tipo,
	],
	'marca'  => [
		'label' => $filter_marca_label,
		'icon'  => $filter_marca_icon ?: $icons_default['marca'],
		'items' => $items_marca,
	],
	'motor'  => [
		'label' => $filter_motor_label,
		'icon'  => $filter_motor_icon ?: $icons_default['motor'],
		'items' => $items_motor,
	],
	'plazas' => [
		'label' => $filter_plazas_label,
		'icon'  => $filter_plazas_icon ?: $icons_default['plazas'],
		'items' => $items_plazas,
	],
];

?>

<?php
$active_key = 'tipo';
foreach ( $filters as $key => $filter ) {
	if ( ! empty( $filter['items'] ) ) {
		$active_key = $key;
		break;
	}
}
?>

<section class="w-full bg-neutral-50 py-12 md:py-16" data-cat-block="<?php echo esc_attr( $block['id'] ); ?>">
	<div class="mx-auto w-full max-w-7xl px-4 lg:px-8">
		<div class="flex flex-col items-start gap-8">
			<h2 class="text-3xl md:text-4xl font-bold font-['Montserrat'] leading-tight bg-gradient-to-r from-indigo-900 to-indigo-950 bg-clip-text text-transparent">
				<?php echo esc_html( $block_title ); ?>
			</h2>

			<div class="mauswp-cat-tabs-scroll flex w-full items-center gap-4 overflow-x-auto whitespace-nowrap pb-2 md:flex-wrap md:overflow-visible md:whitespace-normal" data-cat-tabs role="tablist">
				<?php foreach ( $filters as $key => $filter ) : ?>
					<?php
					$is_active = ( $key === $active_key );
					$button_classes = $is_active
						? "border-primary-300 text-primary-300 font-bold font-['Open_Sans']"
						: "border-neutral-300 text-slate-600 font-medium font-['Open_Sans']";
					?>
					<button
						type="button"
						class="inline-flex items-center gap-2 rounded-lg border px-4 py-2 text-base font-semibold transition hover:border-primary-300 hover:text-primary-300 focus:outline-none focus-visible:ring-2 focus-visible:ring-primary-300 <?php echo esc_attr( $button_classes ); ?>"
						data-cat-tab="<?php echo esc_attr( $key ); ?>"
						role="tab"
						aria-selected="<?php echo $is_active ? 'true' : 'false'; ?>"
						aria-controls="cat-panel-<?php echo esc_attr( $block['id'] . '-' . $key ); ?>"
					>
						<span class="text-neutral-700">
							<?php echo $filter['icon']; // phpcs:ignore WordPress.Security.EscapeOutput.OutputNotEscaped ?>
						</span>
						<?php echo esc_html( $filter['label'] ); ?>
						<span class="text-neutral-500">
							<?php echo $icons_default['arrow']; // phpcs:ignore WordPress.Security.EscapeOutput.OutputNotEscaped ?>
						</span>
					</button>
				<?php endforeach; ?>
			</div>

			<div class="w-full" data-cat-panels>
				<?php foreach ( $filters as $key => $filter ) : ?>
					<?php $is_active = ( $key === $active_key ); ?>
					<div
						id="cat-panel-<?php echo esc_attr( $block['id'] . '-' . $key ); ?>"
						class="<?php echo $is_active ? '' : 'hidden'; ?>"
						data-cat-panel="<?php echo esc_attr( $key ); ?>"
						role="tabpanel"
						aria-hidden="<?php echo $is_active ? 'false' : 'true'; ?>"
					>
						<?php
						$items = $filter['items'] ?: [];
						$cols  = max( 1, min( 5, count( $items ) ) );
						?>
						<?php if ( $items ) : ?>
							<div
								class="mauswp-cat-grid mt-6 w-full gap-6"
								style="--mauswp-cat-cols: <?php echo (int) $cols; ?>;"
							>
								<?php foreach ( $items as $item ) : ?>
									<?php
									$title  = $item['title'] ?? '';
									$image  = $item['image'] ?? null;
									$link   = $item['link'] ?? '';
									?>
									<a href="<?php echo esc_url( $link ?: '#' ); ?>" class="block rounded-[16px] border border-slate-500 bg-white p-4 transition hover:border-primary-400 hover:shadow-md focus:outline-none focus-visible:ring-2 focus-visible:ring-primary-300">
										<div class="overflow-hidden rounded-[14px] border border-neutral-200">
											<?php if ( $image ) : ?>
												<img src="<?php echo esc_url( $image['url'] ); ?>" alt="<?php echo esc_attr( $image['alt'] ); ?>" class="h-48 w-full object-cover" loading="lazy" decoding="async" />
											<?php endif; ?>
										</div>
										<div class="mt-4 flex items-center justify-between">
											<p class="font-['Open_Sans'] text-base font-bold text-gray-800 md:text-lg"><?php echo esc_html( $title ); ?></p>
											<span class="inline-flex h-9 w-9 items-center justify-center rounded-full border border-neutral-500 text-neutral-800 transition hover:border-primary-400 hover:text-primary-400">
												<?php echo $icons_default['arrow']; // phpcs:ignore WordPress.Security.EscapeOutput.OutputNotEscaped ?>
											</span>
										</div>
									</a>
								<?php endforeach; ?>
							</div>
						<?php else : ?>
							<p class="mt-4 text-sm text-neutral-600"><?php esc_html_e( 'No hay elementos en esta pestaña.', 'mauswp' ); ?></p>
						<?php endif; ?>
					</div>
				<?php endforeach; ?>
			</div>
		</div>
	</div>
</section>
